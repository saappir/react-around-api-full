(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{27:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),i=n(17),o=n.n(i),r=n(22),s=n(2),l=n(3),u=(n(27),n(8)),p=n.p+"static/media/logo.4e8e0a1d.svg",d=n(0);var b=function(e){var t=e.email,n=e.linkPath,a=e.linkTitle,c=e.onLogout;return Object(d.jsxs)("div",{className:"header",children:[Object(d.jsx)("img",{src:p,alt:"around the US logo",className:"header__logo"}),Object(d.jsxs)("div",{className:"header__container",children:[Object(d.jsx)("p",{className:"header__email",children:t}),Object(d.jsx)(u.b,{className:"header__link",to:n,onClick:c,children:a})]})]})},j=c.a.createContext();var m=function(e){var t=e.onCardClick,n=e.card,a=e.onCardLike,i=e.onCardDelete,o=c.a.useContext(j),r=n.owner._id===o._id,s="card__delete-button ".concat(r?"card__delete-button_state_visible":"card__delete-button_state_hidden"),l=n.likes.some((function(e){return e._id===o._id})),u="card__like-button ".concat(l&&"card__like-button_state_active");return Object(d.jsxs)("article",{className:"card",children:[Object(d.jsx)("button",{"aria-label":"delete",type:"button",className:s,onClick:function(){i(n)}}),Object(d.jsx)("img",{src:n.link,alt:n.name,className:"card__image",onClick:function(){t(n)}}),Object(d.jsxs)("div",{className:"card__inner",children:[Object(d.jsx)("h2",{className:"card__title",children:n.name}),Object(d.jsxs)("div",{className:"card__likes-container",children:[Object(d.jsx)("button",{"aria-label":"like",type:"button",className:u,onClick:function(){a(n)}}),Object(d.jsx)("span",{className:"card__likes-count",children:n.likes.length})]})]})]})};var h=function(e){var t=e.onCardClick,n=e.onEditAvatarClick,a=e.onEditProfileClick,i=e.onAddPlaceClick,o=e.handleCardLike,r=e.handleCardDelete,s=e.cards,l=c.a.useContext(j);return Object(d.jsxs)("div",{className:"page",children:[Object(d.jsxs)("section",{className:"profile",children:[Object(d.jsxs)("div",{className:"profile__image-container",children:[Object(d.jsx)("img",{src:l.avatar,alt:l.name,className:"profile__image"}),Object(d.jsx)("button",{className:"profile__button profile__button_type_image",onClick:n})]}),Object(d.jsxs)("div",{className:"profile__info",children:[Object(d.jsxs)("div",{className:"profile__inner",children:[Object(d.jsx)("h1",{className:"profile__name",children:l.name}),Object(d.jsx)("button",{"aria-label":"edit",type:"button",className:"profile__button profile__button-hover profile__button_type_edit",onClick:a})]}),Object(d.jsx)("p",{className:"profile__description",children:l.about})]}),Object(d.jsx)("button",{"aria-label":"add",type:"button",className:"profile__button profile__button-hover profile__button_type_add",onClick:i})]}),Object(d.jsx)("section",{className:"cards",children:s.map((function(e){return Object(d.jsx)(m,{card:e,onCardClick:t,onCardLike:o,onCardDelete:r},e._id)}))})]})};var _=function(){return Object(d.jsx)("footer",{className:"footer",children:Object(d.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Around The U.S."})})},f=n(20),O=n(21),g=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(f.a)(this,e),this._customFetch=function(e,t){return fetch(e,t).then((function(e){return e.ok?e.json():Promise.reject(e.statusText)}))},this._headers=a,this._baseUrl=n}return Object(O.a)(e,[{key:"getInitialCards",value:function(){return this._customFetch("".concat(this._baseUrl,"/cards"),{})}},{key:"getUserinfo",value:function(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{})}},{key:"updateUserInfo",value:function(e){return this._customFetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",body:JSON.stringify({name:e.name,about:e.about})})}},{key:"createCard",value:function(e){return this._customFetch("".concat(this._baseUrl,"/cards"),{method:"POST",body:JSON.stringify(e)})}},{key:"deleteCard",value:function(e){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE"})}},{key:"changeLikeCardStatus",value:function(e,t){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:t?"PUT":"DELETE"})}},{key:"setUserAvatar",value:function(e){var t=e.avatar;return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",body:JSON.stringify({avatar:t})})}}]),e}())({baseUrl:"https://api.saappir.students.nomoreparties.sbs"});var x=function(e){var t=e.isOpen,n=e.name,a=e.title,c=e.onClose,i=e.children,o=e.submitText,r=e.onSubmit;return Object(d.jsx)("section",{className:"popup popup_type_".concat(n,", ").concat(t&&"popup_visible"),children:Object(d.jsxs)("div",{className:"popup__container",children:[Object(d.jsx)("button",{"aria-label":"exit",type:"button",className:"popup__exit-button",onClick:c}),Object(d.jsxs)("form",{className:"popup__form popup__".concat(n,"-form"),onSubmit:r,children:[Object(d.jsx)("h2",{className:"popup__title",children:a}),i,Object(d.jsx)("button",{type:"submit",className:"popup__submit-button",children:o})]})]})})};var v=function(e){var t=e.isOpen,n=e.onClose,a=e.card;return Object(d.jsx)("div",{className:"popup popup_type_image ".concat(t&&"popup_visible"),children:Object(d.jsxs)("div",{className:"popup__container",children:[Object(d.jsx)("button",{"aria-label":"exit",type:"button",className:"popup__exit-button popup__exit-image",onClick:n}),Object(d.jsxs)("figure",{className:"popup__figure",children:[Object(d.jsx)("img",{className:"popup__figure-image",src:a.link,alt:a.name}),Object(d.jsx)("figcaption",{className:"popup__figure-caption",children:a.name})]})]})})};var C=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateUser,i=c.a.useState(""),o=Object(s.a)(i,2),r=o[0],l=o[1],u=c.a.useState(""),p=Object(s.a)(u,2),b=p[0],m=p[1],h=c.a.useContext(j);return c.a.useEffect((function(){l(h.name||""),m(h.about||"")}),[h,t]),Object(d.jsxs)(x,{name:"edit",title:"Edit profile",submitText:"Save",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:r,about:b})},children:[Object(d.jsxs)("label",{className:"popup__input-label",children:[Object(d.jsx)("input",{className:"popup__input popup__input_content_name",type:"text",name:"name",id:"input-name",placeholder:"Name",minLength:2,maxLength:40,required:!0,value:r,onChange:function(e){l(e.target.value)}}),Object(d.jsx)("span",{className:"popup__input-error input-name-error"})]}),Object(d.jsxs)("label",{className:"popup__input-label",children:[Object(d.jsx)("input",{className:"popup__input popup__input_content_description",type:"text",name:"about",id:"input-description",placeholder:"Job",minLength:2,maxLength:200,required:!0,value:b,onChange:function(e){m(e.target.value)}}),Object(d.jsx)("span",{className:"popup__input-error input-description-error"})]})]})};var k=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,i=c.a.useRef("");return Object(d.jsx)(x,{name:"image",title:"Update profile picture",submitText:"Save",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({avatar:i.current.value})},children:Object(d.jsxs)("label",{className:"popup__input-label",children:[Object(d.jsx)("input",{className:"popup__input popup__input_content_profile-image",type:"url",name:"link",id:"input-avatar",placeholder:"Image link",required:!0,ref:i}),Object(d.jsx)("span",{className:"popup__input-error input-avatar-error"})]})})};var N=function(e){var t=e.isOpen,n=e.onClose,a=e.onAddPlace,i=c.a.useState(""),o=Object(s.a)(i,2),r=o[0],l=o[1],u=c.a.useState(""),p=Object(s.a)(u,2),b=p[0],j=p[1];return c.a.useEffect((function(){l(""),j("")}),[t]),Object(d.jsxs)(x,{name:"add",title:"New place",submitText:"Create",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:r,link:b})},children:[Object(d.jsxs)("label",{className:"popup__input-label",children:[Object(d.jsx)("input",{className:"popup__input popup__input_content_title",type:"text",name:"name",id:"input-title",value:r,placeholder:"Title",required:"1",maxLength:"30",onChange:function(e){l(e.target.value)}}),Object(d.jsx)("span",{className:"popup__input-error input-title-error"})]}),Object(d.jsxs)("label",{className:"popup__input-label",children:[Object(d.jsx)("input",{className:"popup__input popup__input_content_link",type:"url",name:"link",id:"input-image",value:b,placeholder:"Image link",required:!0,onChange:function(e){j(e.target.value)}}),Object(d.jsx)("span",{className:"popup__input-error input-image-error"})]})]})},y=function(e){var t=e.children,n=e.loggedIn;return Object(d.jsx)(l.b,{children:function(){return n?t:Object(d.jsx)(l.a,{to:"/signin"})}})};var S=function(e){var t=e.title,n=e.linkText,a=e.linkPath,c=e.onSubmit,i=e.onEmailChange,o=e.onPasswordChange,r=e.email,s=e.password;return Object(d.jsxs)("section",{className:"homepage",children:[Object(d.jsxs)("form",{className:"homepage__form",onSubmit:c,children:[Object(d.jsx)("h2",{className:"homepage__title",children:t}),Object(d.jsx)("label",{className:"homepage__input-label",children:Object(d.jsx)("input",{className:"homepage__input",type:"email",name:"email",id:"email",placeholder:"Email",onChange:i,value:r,required:!0})}),Object(d.jsx)("label",{className:"homepage__input-label",children:Object(d.jsx)("input",{className:"homepage__input",type:"password",name:"password",id:"password",placeholder:"Password",onChange:o,value:s,required:!0})}),Object(d.jsx)("button",{type:"submit",className:"homepage__submit",children:t})]}),Object(d.jsx)(u.b,{to:a,className:"homepage__link",children:n})]})};var w=Object(l.h)((function(e){var t=e.onLogin,n=Object(a.useState)(""),c=Object(s.a)(n,2),i=c[0],o=c[1],r=Object(a.useState)(""),l=Object(s.a)(r,2),u=l[0],p=l[1];return Object(d.jsx)(S,{title:"Log in",linkText:"Not a member yet? Sign up here!",linkPath:"/signup",onSubmit:function(e){e.preventDefault(),t({email:i,password:u})},onEmailChange:function(e){o(e.target.value)},onPasswordChange:function(e){p(e.target.value)},email:i,password:u})}));var T=Object(l.h)((function(e){var t=e.onRegister,n=Object(a.useState)(""),c=Object(s.a)(n,2),i=c[0],o=c[1],r=Object(a.useState)(""),l=Object(s.a)(r,2),u=l[0],p=l[1];return Object(d.jsx)(S,{title:"Sign up",linkText:"Already a member? Log in here!",linkPath:"signin",onSubmit:function(e){e.preventDefault(),t({email:i,password:u})},onEmailChange:function(e){o(e.target.value)},onPasswordChange:function(e){p(e.target.value)},email:i,password:u})})),P=n.p+"static/media/fail.df8eddf6.svg",U=n.p+"static/media/confirm.1b6082f8.svg";var L=function(e){var t=e.onClose,n=e.isOpen;return Object(d.jsx)("div",{className:"popup popup_type_confirm ".concat(n&&"popup_visible"),children:Object(d.jsx)("div",{className:"popup__container",children:Object(d.jsxs)("div",{className:"popup__form",children:[Object(d.jsx)("button",{"aria-label":"exit",type:"button",className:"popup__exit-button popup__exit-image",onClick:t}),Object(d.jsx)("img",{className:"popup__icon",alt:"confirm-icon",src:e.message?U:P}),Object(d.jsx)("p",{className:"popup__icon-text",children:e.message?"Success! You have now been registered.":"Oops, something went wrong! Please try again."})]})})})},E="https://api.saappir.students.nomoreparties.sbs",A=function(e){return e.ok?e.json():Promise.reject(e.statusText)};var I=function(){var e=Object(a.useState)({}),t=Object(s.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(!1),u=Object(s.a)(o,2),p=u[0],m=u[1],f=Object(a.useState)(!1),O=Object(s.a)(f,2),S=O[0],P=O[1],U=Object(a.useState)(!1),I=Object(s.a)(U,2),D=I[0],F=I[1],q=Object(a.useState)(!1),J=Object(s.a)(q,2),B=J[0],R=J[1],z=Object(a.useState)(!1),H=Object(s.a)(z,2),Y=H[0],G=H[1],M=Object(a.useState)({}),K=Object(s.a)(M,2),Q=K[0],V=K[1],W=Object(a.useState)([]),X=Object(s.a)(W,2),Z=X[0],$=X[1],ee=Object(a.useState)(!1),te=Object(s.a)(ee,2),ne=te[0],ae=te[1],ce=Object(a.useState)(""),ie=Object(s.a)(ce,2),oe=ie[0],re=ie[1],se=Object(a.useState)(""),le=Object(s.a)(se,2),ue=le[0],pe=le[1],de=Object(l.g)();c.a.useEffect((function(){g.getUserinfo().then(V).catch((function(e){return console.error("user info error",e)}))}),[]),c.a.useEffect((function(){g.getInitialCards().then($).catch((function(e){return console.error("initial cards error",e)}))}),[]),c.a.useEffect((function(){be()}),[de]);var be=function(){var e=localStorage.getItem("token");e&&function(e){return fetch("".concat(E,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return A(e)})).then((function(e){return e}))}(e).then((function(e){e&&(re(e.data.email),ae(!0),de.push("/"))})).catch((function(e){"Bad Request"===e?console.error("400 - Token not provided or provided in the wrong format",e):"Unauthorized"===e?console.error("401 - The provided token is invalid",e):console.error("500 - an error occured",e)}))},je=function(){m(!1),P(!1),F(!1),R(!1),G(!1)};return Object(d.jsx)(j.Provider,{value:Q,children:Object(d.jsxs)("div",{className:"page",children:[Object(d.jsxs)(l.d,{children:[Object(d.jsxs)(l.b,{path:"/signup",children:[Object(d.jsx)(b,{loggedIn:ne,linkPath:"/signin",linkTitle:"Log in"}),Object(d.jsx)(T,{onRegister:function(e){(function(e){var t=e.email,n=e.password;return fetch("".concat(E,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).then((function(e){return A(e)}))})({email:e.email,password:e.password}).then((function(){pe(!0)})).catch((function(e){pe(!1),"Bad Request"===e?console.error("400 - one of the fields was filled in incorrectly",e):console.error("500 - an error occured",e)})).finally((function(){G(!0),de.push("/")}))}}),Object(d.jsx)(L,{loggedIn:ne,onClose:je,isOpen:Y,message:ue})]}),Object(d.jsxs)(l.b,{path:"/signin",children:[Object(d.jsx)(b,{loggedIn:ne,linkPath:"/signup",linkTitle:"Sign up"}),Object(d.jsx)(w,{onLogin:function(e){(function(e){var t=e.email,n=e.password;return fetch("".concat(E,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).then((function(e){return A(e)})).then((function(e){return e.token?(localStorage.setItem("token",e.token),e):void 0}))})({email:e.email,password:e.password}).then((function(e){e.token?(ae(!0),re(e.email)):ae(!1),be()})).catch((function(e){pe(!1),G(!0),"Bad Request"===e?console.error("400 - one or more of the fields were not provided",e):"Unauthorized"===e?console.error("401 - the user with the specified email not found",e):console.error("500 - an error occured",e)})).finally((function(){return de.push("/")}))}}),Object(d.jsx)(L,{loggedIn:ne,onClose:je,isOpen:Y,message:ue})]}),Object(d.jsxs)(y,{loggedIn:ne,exact:!0,path:"/",children:[Object(d.jsx)(b,{loggedIn:ne,onLogout:function(){re(""),ae(!1),de.push("/"),localStorage.removeItem("token")},email:oe,linkPath:"/signup",linkTitle:"Log out"}),Object(d.jsx)(h,{onEditProfileClick:function(){m(!0)},onAddPlaceClick:function(){P(!0)},onEditAvatarClick:function(){F(!0)},onCardClick:function(e){i(e),R(!0)},closeAllPopups:je,handleCardLike:function(e){var t=e.likes.some((function(e){return e._id===Q._id}));g.changeLikeCardStatus(e._id,!t).then((function(t){$((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.error("like card error",e)}))},handleCardDelete:function(e){g.deleteCard(e._id).then((function(){$(Z.filter((function(t){return t._id!==e._id})))})).catch((function(e){return console.error("delete card error",e)}))},cards:Z,currentUser:Q})]})]}),Object(d.jsxs)(y,{loggedIn:ne,children:[ne&&Object(d.jsx)(_,{}),Object(d.jsx)(C,{isOpen:p,onClose:je,onUpdateUser:function(e){g.updateUserInfo(e).then(V).then(je).catch((function(e){return console.error("update user error",e)}))}}),Object(d.jsx)(k,{isOpen:D,onClose:je,onUpdateAvatar:function(e){g.setUserAvatar(e).then(V).then(je).catch((function(e){return console.error("update avatar error",e)}))}}),Object(d.jsx)(N,{isOpen:S,onClose:je,onAddPlace:function(e){g.createCard(e).then((function(e){$([e].concat(Object(r.a)(Z)))})).then(je).catch((function(e){return console.error("add place error",e)}))}}),Object(d.jsx)(x,{name:"delete",title:"Are you sure?",submitText:"Yes",onClose:je}),Object(d.jsx)(v,{card:n,isOpen:B,onClose:je})]})]})})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,35)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),i(e),o(e)}))};o.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(u.a,{children:Object(d.jsx)(I,{})})}),document.getElementById("root")),D()}},[[34,1,2]]]);
//# sourceMappingURL=main.0e3cd2a3.chunk.js.map